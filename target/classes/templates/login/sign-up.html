<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="/main">
<head>
    <meta charset="utf-8"/>
    <title>LoveYuan's Blog登录</title>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
</head>

<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">
            <a class="logo" href="" style="color: #cbcdd0"><i class="layui-icon" style="font-size: 30px; color: #1E9FFF;">&#xe609;</i> LoveYuan's Blog</a>
        </div>
    </div>
    <div class="content-area container login-content" style="width:100%">
        <div class="layui-tab">
            <ul class="layui-tab-title">
                <li class="layui-this">注册</li>
                <li></li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">

                    <form class="layui-form layui-form-pane login-box" method="POST" action="" id="login-box">
                        <div class="layui-form-item ">
                            <label class="layui-form-label">登录名</label>
                            <div class="layui-input-inline">
                                <input id="login_name" class="layui-input" lay-verify="required|loginName" name="login_name" value="" autofocus="" autocomplete="off" placeholder="请输入登录名" type="text" />
                            </div>
                        </div>
                        <div class="layui-form-item ">
                            <label class="layui-form-label">登录昵称</label>
                            <div class="layui-input-inline">
                                <input id="name" class="layui-input" lay-verify="required" name="name" value="" autofocus="" autocomplete="off" placeholder="请输入昵称" type="text" />
                            </div>
                        </div>
                        <div class="layui-form-item ">
                            <label class="layui-form-label">邮箱</label>
                            <div class="layui-input-inline">
                                <input id="email" class="layui-input" lay-verify="required|email" name="email" value="" autofocus="" autocomplete="off" placeholder="请输入邮箱" type="email" />
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">登录密码</label>
                            <div class="layui-input-inline">
                                <input name="password" id="password" lay-verify="required" autocomplete="off" placeholder="请输入登录密码" class="layui-input" autofocus="" type="password"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">确认密码</label>
                            <div class="layui-input-inline">
                                <input id="rePassword" lay-verify="required|rePassword" autocomplete="off" placeholder="请输入确认密码" class="layui-input" autofocus="" type="password"/>
                            </div>
                        </div>
                        <div class="layui-form-item login-btn-box">
                            <button class="layui-btn" lay-submit="" lay-filter="signUp-box" id="signUp">立即注册</button>
                            <span style="padding-left:20px;"><a href="/login/loginHtml">已有账号？登录</a></span>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<footer class="footer">
    <div class="footavatar site-footer clearfix u-textAlignCenter">
        <img th:src="@{../images/lufu.jpg}" alt="官方微信二维码" title="扫码关注官方微信，更多资讯抢先获取" class="footphoto"/>
        <ul class="footinfo">
            <p class="fname"><a>LoveYuan's Blog</a></p>
            <p class="finfo">LoveYuan's Blog</p>
        </ul>
    </div>
    <div class="Copyright">
        <p>
            <!-- <a target="_blank" href="//shang.qq.com/wpa/qunwpa?idkey=c4f068d3baefa9f0e31f6271d9bebe70e542830dd6e713d7689fd2a084a952e7">
                  <img src="//pub.idqqimg.com/wpa/images/group.png" alt="php行业交流" title="php行业交流" border="0"/>
              </a>-->
        </p><br/>
        Powered by <a href="/" target="_blank">LoveYuan's Blog</a>
    </div>
</footer>
<!--<ul class="layui-fixbar"><li class="layui-icon layui-fixbar-top" lay-type="top" style="display: list-item;" ></li></ul>-->
</body>
</html>
<link rel="stylesheet" th:href="@{../css/home.css}"/>
<script>
    layui.use(['form', 'layedit', 'laydate','util'], function() {
        var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate
                , util = layui.util;
        util.fixbar({
            bar1: false
            ,click: function(type){
                console.log(type);
                var timer = null;
                if(type === 'top'){
                    var scrollToTop = window.setInterval(function() {
                        var pos = window.pageYOffset;
                        if ( pos > 0 ) {
                            window.scrollTo( 0, pos - 20 ); // how far to scroll on each step
                        } else {
                            window.clearInterval( scrollToTop );
                        }
                    }, 16);
                    //window.scrollBy(0,-10);scrolldelay=setTimeout(this,1000);
                    // if(document.documentElement.scrollTop==0)clearTimeout(scrolldelay);
                   /* cancelAnimationFrame(timer);
                    timer = requestAnimationFrame(function fn(){
                        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
                        if(oTop > 0){
                            scrollBy(0,-50);
                            timer = requestAnimationFrame(fn);
                        }else{
                            cancelAnimationFrame(timer);
                        }
                    });*/
            }
            }
        });
        form.verify({
            rePassword:function(value){
                if(value != $('#password').val()){
                    return '密码不一致';
                }
            },
            loginName:function (value){
                $.ajax({
                    type: 'post',
                    url: '/user/addUser',
                    data: {'login_name' : value},
                    dataType: "json",
                    success: function (data, status) {
                        if(data.success == false){
                            return data.msg;
                        }
                    },
                });
            }
        });
        form.on('submit(signUp-box)', function(_data){
            layer.alert(JSON.stringify(_data.field), {
                 title: '最终的提交信息'
             });
            $.ajax({
                type: 'post',
                url: '/user/addUser',
                data: _data,
                dataType: "json",
                success: function (data, status) {
                    layer.msg('保存成功,请前往登录页面', {
                        time: 20000, //20s后自动关闭
                        btn: ['好的','取消'],
                        yes: function(){
                            window.location.href = '/login/loginHtml';
                        },
                        btn2:function(){
                            location.reload();
                        }
                    });
                },
            });

    });
    });

/*function  saveUser() {
//    var _validator = $('#signUpForm').data('bootstrapValidator');
//    if (!_validator.isValid()) {
//        _validator.validate();
//        layer.msg('请将信息填写完整!');
//        return  false;
//    }
        //表单提交的方法、比如ajax提交
        var _data = getFormJson('#signUpForm');
        delete  _data.rePassword;
        console.info(_data);
        $.ajax({
            type: 'post',
            url: '/user/addUser',
            data: _data,
            dataType: "json",
            beforeSend: function (XMLHttpRequest) {

            },
            success: function (data, status) {
                layer.msg('保存成功,请前往登录页面', {
                    time: 20000, //20s后自动关闭
                    btn: ['好的','取消'],
                    yes: function(){
                        window.location.href = '/login/loginHtml';
                    },
                    btn2:function(){
                        location.reload();
                    }
                });
            },
            complete: function (XMLHttpRequest, textStatus) {

            },
            error: function () {

            }
        });
        return false;
    }*/
//获取formJSON对象
function getFormJson(form) {
    var o = {};
    var a = $(form).serializeArray();
    $.each(a, function () {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}


</script>